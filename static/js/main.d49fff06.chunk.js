(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{121:function(e,t,n){e.exports=n(217)},203:function(e,t){},205:function(e,t){},217:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=(n(123),n(112)),l=n(58),i=n(30),s=n(24),u=n(12),c=n.n(u),d=Object(s.c)({youtubePlayerBorderEvent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{payload:{youtubeIdUpdateEvent:{moment:c()(),youtubeId:null}}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"YoutubePlayerBorder":return{payload:t.payload}}return e},subtitleBorderEvent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{payload:{playPhaseEvent:{moment:null,startTime:null,endTime:null}}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SubtitleBorder":return{payload:t.payload}}return e}}),p=n(9),m=n(17),h=n(20),y=n(18),b=n(19),g=n(114),v=n(117),f=n.n(v),E=-1,x=1,k=2,C=5,S=n(227),P=n(223),O=n(218),T=n(224),B=n(225),j=n(219),I=n(220),w=n(221),R=function(e){var t=(e=(e.match(/[0-9.]+/g)||[]).join("")).split(".");return t.length>1&&(e=t[0]+"."+t[1]),e},L=function(e){var t=1e3*e,n=c.a.duration(t),a="";a+=n.hours()>=10?n.hours()+":":"0"+n.hours()+":",a+=n.minutes()>=10?n.minutes()+":":"0"+n.minutes()+":",a+=n.seconds()>=10?n.seconds()+".":"0"+n.seconds()+".";for(var r=Math.floor(n.milliseconds()).toString(),o=r.length,l=0;l<3-o;l++)r="0"+r;return a+=r},U=function(e){var t=e.split(".");return 2===t.length&&t[1].length>3&&(e=t[0]+"."+t[1].substring(0,3)),c.a.duration(e).valueOf()/1e3},W=function(e,t){return console.log(e),console.log(t),null!==t&&(null===e||e<t)},A=function e(){var t=this;Object(p.a)(this,e),this.progressTimeId=null,this.youtubePlayer=null,this.onProgressCallback=null,this.eventQueue=[],this.onReady=function(e){t.youtubePlayer=e.target},this.onStateChanged=function(e){var n=t;e.data===x?t.progressTimeId=setInterval(function(){if(n.youtubePlayer){var e=n.youtubePlayer.getCurrentTime();if(n.onProgressCallback&&n.onProgressCallback(e),n.eventQueue.length>0){var t=n.eventQueue.find(function(t){return e>=t.targetTime});void 0!==t&&(t.callback(),n.eventQueue.splice(n.eventQueue.indexOf(t),1))}}},10):clearTimeout(t.progressTimeId)},this.setOnProgress=function(e){t.onProgressCallback=e},this.setAlarm=function(e,n){t.eventQueue.push({targetTime:e,callback:n})}},F=n(85),z=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(y.a)(t).call(this,e))).youtubePlayer=null,n.sendingEvent={youtubeIdUpdateEvent:{moment:null,youtubeId:null}},n.currentEvent={subtitleBorderEvent:{playPhaseEvent:{moment:null,startTime:null,endTime:null}}},n.progressPublisher=new A,n.update=function(e){var t=n.currentEvent.subtitleBorderEvent.playPhaseEvent,a=e.subtitleBorderEvent.playPhaseEvent;W(t.moment,a.moment)&&(n.currentEvent.subtitleBorderEvent.playPhaseEvent=F.clone(a),n.playPhase(a.startTime,a.endTime))},n.playPhase=function(e,t){n.youtubePlayer.seekTo(e),n.youtubePlayer.playVideo(),n.progressPublisher.setAlarm(t,function(){n.youtubePlayer.pauseVideo()})},n.onYoutubeReady=function(e){n.youtubePlayer=e.target,n.progressPublisher.onReady(e)},n.onYoutubeStateChanged=function(e){n.progressPublisher.onStateChanged(e)},n.createAction=function(){return{type:"YoutubePlayerBorder",payload:Object.assign({},F.clone(n.sendingEvent))}},n.onLoadButtonClick=function(e){n.sendingEvent.youtubeIdUpdateEvent.moment=new c.a,n.sendingEvent.youtubeIdUpdateEvent.youtubeId=n.state.youtubeId,n.props.dispatch(n.createAction()),n.youtubePlayer.cueVideoById(n.state.youtubeId)},n.onKeyPressed=function(e){if(null!==n.youtubePlayer){var t=n.youtubePlayer.getPlayerState();switch(e){case"space":console.log(t),t===C?n.youtubePlayer.playVideo():t===E||t===k?n.youtubePlayer.playVideo():t===x&&n.youtubePlayer.pauseVideo();break;case"left":if(t===x||t===k){var a=n.youtubePlayer.getCurrentTime()-parseFloat(n.state.preSeekInterval);n.youtubePlayer.pauseVideo(),n.youtubePlayer.seekTo(a)}break;case"right":if(t===x||t===k){var r=n.youtubePlayer.getCurrentTime()+parseFloat(n.state.nextSeekInterval);n.youtubePlayer.pauseVideo(),n.youtubePlayer.seekTo(r)}}}},n.onProgress=function(e){n.setState({progressTime:e})},n.state={youtubeId:"kze1JkPl5_8",preSeekInterval:"1",nextSeekInterval:"1",progressTime:0},n.progressPublisher.setOnProgress(n.onProgress),n}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillMount",value:function(){this.sendingEvent.youtubeIdUpdateEvent.youtubeId=this.state.youtubeId,this.sendingEvent.youtubeIdUpdateEvent.moment=new c.a,this.props.dispatch(this.createAction())}},{key:"componentWillReceiveProps",value:function(e){this.update(e)}},{key:"render",value:function(){var e=this,t={width:"50px",marginLeft:"15px",marginRight:"5px",textAlign:"center"};return r.a.createElement("div",{style:{position:"relative",width:"100%",height:"auto",boxSizing:"border-box"}},r.a.createElement(S.a,null,r.a.createElement(P.a,{bsStyle:"primary"},r.a.createElement(P.a.Body,null,r.a.createElement(f.a,{handleKeys:["space","left","right","s","S","e","E"],onKeyEvent:function(t,n){return e.onKeyPressed(t)}}),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement(O.a,null,r.a.createElement(T.a,null,r.a.createElement(B.a,{type:"text",placeholder:"youtube id",onChange:function(t){e.setState({youtubeId:t.target.value})},value:this.state.youtubeId}),r.a.createElement(T.a.Button,null,r.a.createElement(j.a,{bsStyle:"primary",onClick:this.onLoadButtonClick},"LOAD"))))),r.a.createElement(g.a,{videoId:this.state.youtubeId,opts:{width:"100%",playerVars:{autoplay:0}},onReady:this.onYoutubeReady,onStateChange:this.onYoutubeStateChanged}))),r.a.createElement(P.a,null,r.a.createElement(P.a.Heading,null,r.a.createElement(P.a.Body,{style:{position:"relative",height:"auto",padding:"0px"}},r.a.createElement("div",{style:{position:"relative",height:"100%",marginBottom:"0px",borderWidth:"0px",borderColor:"red",borderStyle:"solid"}},r.a.createElement(I.a,{inline:!0},r.a.createElement(O.a,null,r.a.createElement(w.a,{style:{fontWeight:"normal"}},"Pre seek interval (left)"),r.a.createElement(T.a,{style:t},r.a.createElement(B.a,{type:"text",value:this.state.preSeekInterval,onChange:function(t){var n=R(t.target.value),a=parseFloat(n);isNaN(a)&&(a=0),e.setState({preSeekInterval:n})}})),r.a.createElement(w.a,{style:{fontWeight:"normal",marginLeft:"15px"}},"Next seek interval (right)"),r.a.createElement(T.a,{style:t},r.a.createElement(B.a,{type:"text",value:this.state.nextSeekInterval,onChange:function(t){var n=R(t.target.value),a=parseFloat(n);isNaN(a)&&(n="0"),e.setState({nextSeekInterval:n})}})))),r.a.createElement("div",{style:{height:"1px",borderWidth:"1px",borderStyle:"solid",borderColor:"#C0C0C0",marginTop:"15px",marginBottom:"15px"}}),r.a.createElement(I.a,{inline:!0},r.a.createElement(O.a,null,r.a.createElement(w.a,{style:{fontWeight:"normal"}},"Progress time"),r.a.createElement(T.a,{style:{marginLeft:"15px"}},r.a.createElement(B.a,{type:"text",value:this.state.progressTime}))))))))))}}]),t}(a.Component),N=Object(i.b)(function(e){return{subtitleBorderEvent:e.subtitleBorderEvent.payload}})(z),V=n(32),X=n(38),Y=n.n(X),_=n(82),D=n(26),J=n(76),K=n.n(J),Q=n(189),H=n(222),M=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(y.a)(t).call(this,e))).updateStateFromProp=function(e){n.setState(Object.assign({},{english:e.english,kor:e.kor,start:e.start,end:e.end,learn:e.learn}))},n.onEnglishTextChanged=function(e){n.setState(Object.assign({},{english:e.target.value}))},n.onKorTextChanged=function(e){n.setState(Object.assign({},{kor:e.target.value}))},n.onRemoveButtonClick=function(e){n.props.onRemoveButtonClicked(n.props.index)},n.onAddButtonClick=function(e){n.props.onAddButtonClicked(n.props.index)},n.onPlayButtonClick=function(e){n.props.onPlayButtonClicked({startTime:n.state.start,endTime:n.state.end})},n.onCheckChanged=function(e){n.setState({learn:e.target.checked})},n.state={english:e.english,kor:e.kor,start:e.start,end:e.end,learn:e.learn},n}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.updateStateFromProp(e)}},{key:"componentDidUpdate",value:function(e,t){e===this.props&&this.props.onStateChanged(this.props,this.state)}},{key:"render",value:function(){var e=this,t={width:"100px",marginLeft:"5px",marginRight:"5px",textAlign:"center"},n={width:"100%",height:"80px",resize:"none"};return r.a.createElement(P.a.Body,{style:{position:"relative",background:"#e9ecef",padding:"0px",height:"auto",borderWidth:this.props.focus?"5px":"0px",borderColor:"red",borderStyle:"dotted",boxSizing:"border-box"}},r.a.createElement("div",{style:{position:"relative",width:"100%",borderStyle:"solid",borderColor:"#C0C0C0",borderWidth:"1px"}}),r.a.createElement("div",{style:{position:"relative",marginTop:"15px"}}),r.a.createElement("div",{style:{float:"left",position:"relative",marginLeft:"15px",borderStyle:"solid",borderColor:"red",borderWidth:"0px",height:"auto"}},r.a.createElement("div",{style:{float:"left",width:"36px",borderStyle:"solid",borderColor:"red",borderWidth:"0px"}},r.a.createElement(j.a,{bsSize:"small",onClick:this.onRemoveButtonClick},r.a.createElement(Q.a,{glyph:"minus"})),r.a.createElement(j.a,{style:{marginTop:"5px"},bsSize:"small",onClick:this.onAddButtonClick},r.a.createElement(Q.a,{glyph:"plus"}))),r.a.createElement("div",{style:{position:"relative",float:"left",height:"100%",borderStyle:"solid",borderColor:"red",borderWidth:"0px"}},r.a.createElement(I.a,{inline:!0},r.a.createElement(O.a,null,r.a.createElement(T.a,{style:t},r.a.createElement(B.a,{type:"text",value:L(this.state.start),onChange:function(t){var n=U(t.target.value);e.setState(Object.assign({},{start:n}))}})),r.a.createElement(w.a,null,"~"),r.a.createElement(T.a,{style:t},r.a.createElement(B.a,{type:"text",value:L(this.state.end),onChange:function(t){var n=U(t.target.value);e.setState(Object.assign({},{end:n}))}})))),r.a.createElement(H.a,{style:{marginLeft:"5px"},checked:this.state.learn,onChange:this.onCheckChanged},"Learning")),r.a.createElement("div",{style:{float:"left",width:"266px",marginRight:"15px",marginBottom:"15px",boxSizing:"border-box",borderWidth:"0px",borderColor:"red",borderStyle:"solid"}},r.a.createElement(O.a,null,r.a.createElement(B.a,{style:n,componentClass:"textarea",placeholder:"",value:this.state.english,onChange:this.onEnglishTextChanged}),r.a.createElement("div",{style:{marginTop:"5px"}}),r.a.createElement(B.a,{style:n,componentClass:"textarea",placeholder:"",value:this.state.kor,onChange:this.onKorTextChanged})),r.a.createElement("div",{style:{position:"relative",float:"right",clear:"left",borderWidth:"0px",borderColor:"red",borderStyle:"solid"}},r.a.createElement(j.a,{bsSize:"small",style:{marginLeft:"5px"},onClick:this.onPlayButtonClick},"PLAY")))))}}]),t}(r.a.Component);M.defaultProps={domHeight:204};var $=M,G=(n(98),n(120)),q=n(226),Z=function(e){Object(G.confirmAlert)({customUI:function(t){var n=t.onClose,a={display:"table",marginLeft:"auto",marginRight:"auto"};return r.a.createElement("div",{className:"custom-ui"},r.a.createElement(q.a,{bsStyle:"info"},r.a.createElement("div",{style:a},r.a.createElement("h4",null,"\uc54c\ub9bc")),r.a.createElement("div",{style:{padding:"5px"}}),r.a.createElement("p",null,e),r.a.createElement("div",{style:{padding:"10px"}}),r.a.createElement("div",{style:a},r.a.createElement(j.a,{bsStyle:"info",onClick:n},"\ud655\uc778"))))}})},ee=n(85),te=n(193),ne=n(214),ae=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(y.a)(t).call(this,e))).currentEvent={youtubePlayerBorderEvent:{youtubeIdUpdateEvent:{moment:null,youtubeId:null}}},n.sendingEvent={playPhaseEvent:{moment:null,startTime:null,endTime:null}},n.dom=null,n.element=null,n.fileReader=null,n.onFileContentLoaded=function(e){try{var t=JSON.parse(ne.xml2json(e,{compact:!0,spaces:4}));console.log(t);var a=[];t.transcript&&t.transcript.text&&t.transcript.text.length>0&&(t.transcript.text.map(function(e){var t=e._attributes;return e.dur=parseFloat(t.dur),e.start=parseFloat(t.start),e.end=e.start+e.dur,e.learn="true"===t.learning,e.english=e._text,e.kor=void 0===t.kor?"":t.kor,delete e._attributes,delete e._text,e}),a=t.transcript.text),console.log(a),n.setState({transcript:a}),n.refs.fileUploader.value=""}catch(r){Z("\ud30c\uc77c\uc5d0 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4.")}},n.update=function(){var e=Object(_.a)(Y.a.mark(function e(t){var a,r,o;return Y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),a=t.youtubePlayerBorderEvent.youtubeIdUpdateEvent,r=n.currentEvent.youtubePlayerBorderEvent.youtubeIdUpdateEvent,!W(r.moment,a.moment)){e.next=18;break}if(n.currentEvent.youtubePlayerBorderEvent.youtubeIdUpdateEvent=ee.clone(a),console.log(a.youtubeId),null===a.youtubeId){e.next=18;break}return e.prev=7,e.next=10,n.fetchTranscriptXml(a.youtubeId);case 10:o=e.sent,n.setState({transcript:o}),console.log(o),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),Z("youtubeId\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");case 18:case"end":return e.stop()}},e,this,[[7,15]])}));return function(t){return e.apply(this,arguments)}}(),n.onExportButtonClicked=function(e){var t=n.currentEvent.youtubePlayerBorderEvent.youtubeIdUpdateEvent.youtubeId,a=n.refineTranscriptToXmlJson(),r=new Blob([a],{type:"text/plain"});n.element.href=URL.createObjectURL(r),n.element.download="".concat(t,".xml"),n.element.click()},n.onImportButtonClicked=function(e){n.refs.fileUploader.click()},n.onChangeFile=function(e){e.stopPropagation(),e.preventDefault();var t=e.target.files[0];t&&n.fileReader.readAsText(t)},n.onReorderButtonClicked=function(e){n.sortTranscripts()},n.refineTranscriptToXmlJson=function(){var e={declaration:{attributes:{version:"1.0",encoding:"utf-8"}},elements:[{type:"element",name:"transcript",elements:[]}]},t=Object(V.a)(n.state.transcript),a=e.elements[0].elements;return t.forEach(function(e){console.log(e.kor);var t={type:"element",name:"text",attributes:{start:e.start.toString(),dur:(e.end-e.start).toString(),learning:e.learn.toString(),kor:e.kor},elements:[{type:"text",text:e.english}]};a.push(t)}),ne.json2xml(e,{compact:!1,ignoreComment:!0,spaces:4})},n.createAction=function(){return{type:"SubtitleBorder",payload:Object.assign({},ee.clone(n.sendingEvent))}},n.htmlDecode=function(e){return n.dom.innerHTML=e,0===n.dom.childNodes.length?"":n.dom.childNodes[0].nodeValue},n.fetchTranscriptXml=function(){var e=Object(_.a)(Y.a.mark(function e(t){var a,r;return Y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K()("https://www.youtube.com/api/timedtext?v=".concat(t,"&lang=en"),{method:"GET"}).then(function(e){return e.text()}).then(function(e){return e});case 2:return a=e.sent,e.next=5,new Promise(function(e,t){return te.parseString(a,function(n,a){n?t(n):e(a.transcript.text)})});case 5:return(r=e.sent).map(function(e){return e.start=parseFloat(e.$.start),e.dur=parseFloat(e.$.dur),e.end=e.start+e.dur,e.english=n.htmlDecode(e._),e.learn=!1,e.focus=!1,e.kor="",delete e.$,delete e._,e}),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.removeSubtitleElement=function(e){n.setState({transcript:Object(V.a)(n.state.transcript).filter(function(t,n){return n!==e})})},n.addSubtitleElement=function(e){console.log("addSubtitleElement");var t=n.state.transcript[e],a=e<n.state.transcript.length-1?n.state.transcript[e+1]:null,r=null===a?0:a.start-t.end,o={dur:r,start:t.end,end:t.end+r,english:"",learn:!1},l=Object(V.a)(n.state.transcript);l.splice(e+1,0,o),l.join(),n.setState({transcript:l})},n.playPhase=function(e){n.sendingEvent.playPhaseEvent.moment=c()(),n.sendingEvent.playPhaseEvent.startTime=e.startTime,n.sendingEvent.playPhaseEvent.endTime=e.endTime,n.props.dispatch(n.createAction())},n.onStateChanged=function(e,t){var a=Object(V.a)(n.state.transcript).map(function(n,a){return a===e.index&&(n.english=t.english,n.kor=t.kor,n.start=t.start,n.end=t.end,n.learn=t.learn),n});n.setState({transcript:a}),console.log("onStateChanged")},n.sortTranscripts=function(){if(!(n.state.transcript.length<2)){var e=Object(V.a)(n.state.transcript);e.sort(function(e,t){return e.start-t.start}),n.setState({transcript:e})}},n.state={transcript:[],nearNext:""},n.update=n.update.bind(Object(D.a)(Object(D.a)(n))),n.fetchTranscriptXml=n.fetchTranscriptXml.bind(Object(D.a)(Object(D.a)(n))),n.dom=document.createElement("div"),n.element=document.createElement("a"),n.fileReader=new FileReader,n.fileReader.onload=function(){n.onFileContentLoaded(n.fileReader.result)},n}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.update(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{position:"absolute",marginLeft:"630px",width:"auto"}},r.a.createElement(S.a,null,r.a.createElement(P.a,{bsStyle:"primary",style:{height:"100%"}},r.a.createElement(P.a.Heading,{style:{fontSize:"16px"}},"SUBTITLE"),r.a.createElement(P.a.Body,{style:{position:"relative",boxSizing:"border-box",height:"676px",padding:"0px"}},r.a.createElement("div",{style:{overflow:"scroll",height:"100%",borderWidth:"1px",borderColor:"black",borderStyle:""}},this.state.transcript.map(function(t,n){return r.a.createElement($,{key:n,english:t.english,index:n,start:t.start,end:t.end,learn:t.learn,focus:t.focus,kor:t.kor,onStateChanged:e.onStateChanged,onAddButtonClicked:e.addSubtitleElement,onRemoveButtonClicked:e.removeSubtitleElement,onPlayButtonClicked:e.playPhase})})))),r.a.createElement(P.a,null,r.a.createElement(P.a.Heading,null,r.a.createElement(P.a.Body,{style:{position:"relative",height:"auto",padding:"0px"}},r.a.createElement("input",{onChange:this.onChangeFile,type:"file",id:"file",ref:"fileUploader",style:{display:"none"}}),r.a.createElement("div",{style:{position:"relative",height:"100%",marginBottom:"0px",borderWidth:"0px",borderColor:"red",borderStyle:"solid"}},r.a.createElement(j.a,{style:{position:"relative",float:"right"},bsSize:"small",onClick:this.onExportButtonClicked},"EXPORT"),r.a.createElement(j.a,{style:{position:"relative",float:"right",marginRight:"5px"},bsSize:"small",onClick:this.onImportButtonClicked},"IMPORT"),r.a.createElement(j.a,{style:{position:"relative",float:"right",marginRight:"5px"},bsSize:"small",onClick:this.onReorderButtonClicked},"REORDER")))))))}}]),t}(a.Component),re=Object(i.b)(function(e){return{youtubePlayerBorderEvent:e.youtubePlayerBorderEvent.payload}})(ae),oe=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{style:{position:"absolute",width:"610px"}},r.a.createElement(N,null)),r.a.createElement(re,null))}}]),t}(a.Component),le=document.getElementById("root"),ie=Object(s.d)(d,Object(s.a)(o.a));Object(l.render)(r.a.createElement(i.a,{store:ie},r.a.createElement(oe,null)),le)}},[[121,2,1]]]);
//# sourceMappingURL=main.d49fff06.chunk.js.map